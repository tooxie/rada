type Mutation {
  createArtist(input: CreateArtistInput!): Artist
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])
  updateArtist(id: ID!, input: UpdateArtistInput!): Artist
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])
  deleteArtist(id: ID!): Artist
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])
  deleteCascadeArtist(id: ID!): Artist
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])

  createAlbum(input: CreateAlbumInput!): Album
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])
  updateAlbum(id: ID!, input: UpdateAlbumInput!): Album
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])
  deleteAlbum(id: ID!): Album
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])
  deleteCascadeAlbum(id: ID!): Album
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])

  createTrack(input: CreateTrackInput!): Track
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])
  updateTrack(albumId: ID!, id: ID!, input: UpdateTrackInput!): Track
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])
  deleteTrack(albumId: ID!, id: ID!): Track
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])

  registerServer(input: RegisterServerInput): Server
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])
  deleteServer(id: ID!): Server
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])
  createServerInvite: CreateServerInviteResponse
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])
  deleteServerInvite(id: ID!): ServerInvite
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])

  createInvite(input: CreateInviteInput!): InviteUrl
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])
  revokeInvite(id: ID!): Boolean
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])
  markInviteUnsolicited(id: ID!): Boolean
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])
}

type Query {
  getAlbum(id: ID!): Album
		@aws_oidc
    @aws_cognito_user_pools
  listAlbums(filter: TableAlbumFilterInput): AlbumConnection
		@aws_oidc
    @aws_cognito_user_pools

  getArtist(id: ID!): Artist
		@aws_oidc
    @aws_cognito_user_pools
  listArtists(filter: TableArtistFilterInput): ArtistConnection
		@aws_oidc
    @aws_cognito_user_pools
  listArtistsForAlbum(id: ID!): [Artist!]
		@aws_oidc
    @aws_cognito_user_pools

  getTrack(albumId: ID!, id: ID!): Track
		@aws_oidc
    @aws_cognito_user_pools
  listOrphanTracks: TrackConnection
		@aws_oidc
    @aws_cognito_user_pools

  listServers: ServerConnection
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])
  listServerInvites: ServerInviteConnection
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])
  getInvite(id: ID!): Invite
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])
  listInvites(filter: TableInviteFilterInput): InviteConnection
    @aws_auth(cognito_groups: ["${COGNITO_ADMIN_GROUP_NAME}"])
}

type Subscription {
  onCreateArtist(id: ID, name: String): Artist
    @aws_subscribe(mutations: ["createArtist"])
  onUpdateArtist(id: ID, name: String): Artist
    @aws_subscribe(mutations: ["updateArtist"])
  onDeleteArtist(id: ID, name: String): Artist
    @aws_subscribe(mutations: ["deleteArtist"])

  onCreateAlbum(id: ID, name: String): Album
    @aws_subscribe(mutations: ["createAlbum"])
  onUpdateAlbum(id: ID, name: String): Album
    @aws_subscribe(mutations: ["updateAlbum"])
  onDeleteAlbum(id: ID, name: String): Album
    @aws_subscribe(mutations: ["deleteAlbum"])

  onCreateTrack(id: ID, title: String): Track
    @aws_subscribe(mutations: ["createTrack"])
  onUpdateTrack(id: ID, title: String): Track
    @aws_subscribe(mutations: ["updateTrack"])
  onDeleteTrack(id: ID, title: String): Track
    @aws_subscribe(mutations: ["deleteTrack"])
}

input TableBooleanFilterInput {
  ne: Boolean
  eq: Boolean
}

input TableFloatFilterInput {
  ne: Float
  eq: Float
  le: Float
  lt: Float
  ge: Float
  gt: Float
  contains: Float
  notContains: Float
  between: [Float]
}

input TableIDFilterInput {
  ne: ID
  eq: ID
  le: ID
  lt: ID
  ge: ID
  gt: ID
  contains: ID
  notContains: ID
  between: [ID]
  beginsWith: ID
}

input TableIntFilterInput {
  ne: Int
  eq: Int
  le: Int
  lt: Int
  ge: Int
  gt: Int
  contains: Int
  notContains: Int
  between: [Int]
}

input TableStringFilterInput {
  ne: String
  eq: String
  le: String
  lt: String
  ge: String
  gt: String
  contains: String
  notContains: String
  between: [String]
  beginsWith: String
}

# --- Artist
input TableArtistFilterInput {
  name: TableStringFilterInput
}

type Artist @aws_oidc @aws_cognito_user_pools {
  serverId: ID!
  id: ID!
  name: String
  imageUrl: AWSURL
  albums: [Album!]
}

type ArtistConnection @aws_oidc @aws_cognito_user_pools {
  items: [Artist!]
}

input CreateArtistInput {
  name: String!
  imageUrl: AWSURL
  albums: [CreateAlbumInput]
}

input UpdateArtistInput {
  name: String
  imageUrl: AWSURL
}

# --- Album
input TableAlbumFilterInput {
  name: TableStringFilterInput
}

type Album @aws_oidc @aws_cognito_user_pools {
  serverId: ID!
  id: ID!
  artists: [Artist!]
  name: String
  imageUrl: AWSURL
  year: Int
  volumes: Int!
  tracks: [Track!]
  isVa: Boolean
}

type AlbumConnection @aws_oidc @aws_cognito_user_pools {
  items: [Album!]
}

input CreateAlbumInput {
  artists: [ID!]
  name: String!
  imageUrl: AWSURL
  year: Int
  volumes: Int!
}

input UpdateAlbumInput {
  name: String
  imageUrl: AWSURL
  year: Int
  volumes: Int
}

# --- Track
input TableTrackFilterInput {
  albumId: TableStringFilterInput
}

type Track @aws_oidc @aws_cognito_user_pools {
  serverId: ID!
  albumId: ID!
  id: ID!
  album: Album
  artists: [Artist!]
  url: AWSURL!
  title: String
  info: String
  lengthInSeconds: Int
  ordinal: Int
  volume: Int!
  side: Int!
  hash: String!
  features: [String!]
  path: String!
}

type TrackConnection @aws_oidc @aws_cognito_user_pools {
  items: [Track!]
}

input CreateTrackInput {
  albumId: ID!
  url: AWSURL!
  title: String
  lengthInSeconds: Int
  ordinal: Int
  volume: Int!
  side: Int!
  artists: [ID!]
  hash: String!
  path: String!
}

input UpdateTrackInput {
  title: String
  url: AWSURL
  lengthInSeconds: Int
  ordinal: Int
  volume: Int
  side: Int
  artists: [ID!]
  hash: String
  path: String
}

# --- Invite
input TableInviteFilterInput {
  id: TableIDFilterInput
  timestamp: TableStringFilterInput
  note: TableStringFilterInput
  visited: TableIntFilterInput
  installed: TableIntFilterInput
  unsolicited: TableIntFilterInput
}

type Invite {
  id: ID!
  timestamp: Int!
  note: String
  validity: Int
  visited: Int
  installed: Int
  unsolicited: Int
}

type InviteUrl {
  claimUrl: AWSURL!
}

type InviteConnection {
  items: [Invite!]
}

input CreateInviteInput {
  note: String
  validity: Int
  isAdmin: Boolean
}

# --- Server
type Server {
  id: ID!
  name: String!
  note: String
  apiUrl: AWSURL!
  headerUrl: AWSURL
  timestamp: Int!
  banned: Boolean
  userPoolId: String!
  clientId: String!
  region: String!
  idpUrl: AWSURL!
  identityPoolId: String!
}

type ServerConnection {
  items: [Server!]
}

# --- Server invites
type ServerInvite {
  id: ID!
  timestamp: Int!
}

type CreateServerInviteResponse {
  id: ID!
  timestamp: Int!
  secret: String!
  clientIdUrl: AWSURL!
}

type ServerInviteConnection {
  items: [ServerInvite!]
}

# --- Register server
input RegisterServerServerInput {
  id: ID!
  name: String!
  apiUrl: AWSURL!
  idpUrl: AWSURL!
  headerUrl: AWSURL
}

input RegisterServerInviteInput {
  id: ID!
  timestamp: Int!
  secret: String!
  clientIdUrl: AWSURL!
}

input RegisterServerInput {
  invite: RegisterServerInviteInput!
  server: RegisterServerServerInput!
}
